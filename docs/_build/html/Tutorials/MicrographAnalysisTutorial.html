<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Micrograph analysis tutorial &mdash; SimpliPyTEM 0.1.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="MicroVideo Class" href="../MicroVideo_class.html" />
    <link rel="prev" title="Micrograph Class" href="../Micrograph_class.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> SimpliPyTEM
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../SimpliPyTEM-GUI.html">SimpliPyTEM-GUI</a></li>
</ul>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Micrograph_class.html">Micrograph Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MicroVideo_class.html">MicroVideo Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PDF_generator.html">PDF generator module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../html_writer.html">HTML writer module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Particle_analysis.html">Particle analysis module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../SimpliPyTEM-GUI.html">SimpliPyTEM-GUI</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Micrograph analysis tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Import-dependancies">Import dependancies</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Initialise-the-Micrograph-object-and-open-a-micrograph">Initialise the Micrograph object and open a micrograph</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Lets-familiarise-ourselves-with-the-Micrograph-object.">Lets familiarise ourselves with the Micrograph object.</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Other-properties-and-metadata">Other properties and metadata</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#What-is-the-pixel-size-of-my-image?">What is the pixel size of my image?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Micrograph-Editing">Micrograph Editing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Convert-to-8-bit">Convert to 8 bit</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Improving-contrast">Improving contrast</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Clip-Contrast">Clip Contrast</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Enhance_contrast">Enhance_contrast</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Histogram-equalisation">Histogram equalisation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Micrograph-Filters!">Micrograph Filters!</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Gaussian-filter">Gaussian filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Median-Filter">Median Filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Weiner-filter">Weiner filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Low-pass-filtering">Low pass filtering</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Non-local-means-filter">Non-local means filter</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Add-a-scalebar">Add a scalebar</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Saving-the-image">Saving the image</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#Automating-Pipelines">Automating Pipelines</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Getting-more-information">Getting more information</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Any-more-questions?">Any more questions?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="MicroVideoAnalysisTutorial.html">Analysing TEM videos with SimpliPyTEM</a></li>
<li class="toctree-l1"><a class="reference internal" href="MicroVideoAnalysisTutorial.html#Advanced-functions">Advanced functions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SimpliPyTEM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../Micrograph_class.html">Micrograph Class</a></li>
      <li class="breadcrumb-item active">Micrograph analysis tutorial</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/Tutorials/MicrographAnalysisTutorial.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars and line breaks on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
    white-space: pre;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Micrograph-analysis-tutorial">
<h1>Micrograph analysis tutorial<a class="headerlink" href="#Micrograph-analysis-tutorial" title="Permalink to this headline"></a></h1>
<p>This is a tutorial on how to use SimpliPyTEM to simplify the analysis of electron microscopy images. This includes basic functions including filtering, converting the file to 8-bit, looking at metadata and more.</p>
<section id="Import-dependancies">
<h2>Import dependancies<a class="headerlink" href="#Import-dependancies" title="Permalink to this headline"></a></h2>
<p>The reason it says &lt;Figure size…&gt; is because I run plt.gray() which makes plt.imshow() show data in a grayscale image by default, this can be ignored.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">SimpliPyTEM.Micrograph_class</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Figure size 432x288 with 0 Axes&gt;
</pre></div></div>
</div>
</section>
<section id="Initialise-the-Micrograph-object-and-open-a-micrograph">
<h2>Initialise the Micrograph object and open a micrograph<a class="headerlink" href="#Initialise-the-Micrograph-object-and-open-a-micrograph" title="Permalink to this headline"></a></h2>
<p>The Micrograph object is the heart of SimpliPyTEM for images, this contains the methods, data and metadata available with SimpliPyTEM. To use, initialise the object and then run one of the methods to open a file - open_dm for digital micrograph files, open_mrc for mrc files and open_tif for tif files.</p>
<p>Note that if a video (or dose fractionation) dm file is provided, the micrograph object will automatically sum the frames, opening it as an image. To load video files as videos, use the MicroVideo object.</p>
<p>An example image is included with this tutorial, and at times will be commented on itself, however you are very welcome to use your own image, hopefully very similar results will be seen.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#initialise object called im, this currently is an empty object</span>

<span class="n">micrograph</span> <span class="o">=</span> <span class="n">Micrograph</span><span class="p">()</span>

<span class="c1">#open micrograph</span>

<span class="n">micrograph</span><span class="o">.</span><span class="n">open_dm</span><span class="p">(</span><span class="s1">&#39;Fibres_1.dm4&#39;</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Fibres_1.dm4 opened as a Micrograph object
</pre></div></div>
</div>
<section id="Lets-familiarise-ourselves-with-the-Micrograph-object.">
<h3>Lets familiarise ourselves with the Micrograph object.<a class="headerlink" href="#Lets-familiarise-ourselves-with-the-Micrograph-object." title="Permalink to this headline"></a></h3>
<p>This is a python object which contains the image data, metadata, and methods to handle the image. The most important thing is to access the image, this can be done through the command below:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">micrograph</span><span class="o">.</span><span class="n">image</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[87.23246 , 86.38291 , 86.516396, ..., 87.19017 , 88.86917 ,
        82.34212 ],
       [86.44894 , 87.66452 , 84.58407 , ..., 85.438576, 89.200165,
        88.086525],
       [86.43705 , 84.47445 , 86.52498 , ..., 86.38407 , 85.472595,
        84.07268 ],
       ...,
       [85.759094, 87.77494 , 86.74983 , ..., 82.411934, 89.37634 ,
        87.11478 ],
       [85.04781 , 84.74883 , 86.7178  , ..., 84.66849 , 80.004654,
        83.33404 ],
       [90.80583 , 85.61487 , 87.782974, ..., 86.793175, 85.618965,
        85.15231 ]], dtype=float32)
</pre></div></div>
</div>
<p>This output shows the image data, this is kept as a 2D array with all the pixel values that make up an image. To see the shape of the image you can use the .shape property</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">micrograph</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># or, to make it easier:</span>

<span class="nb">print</span><span class="p">(</span><span class="n">micrograph</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(3710, 3838)
(3710, 3838)
</pre></div></div>
</div>
<p>Well this is a start, but who wants to look at the actual values in the array? lets see what the image actually looks like, this can be done using matplotlib.pyplot.imshow() or through a built in function that calls this.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">micrograph</span><span class="o">.</span><span class="n">imshow</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Tutorials_MicrographAnalysisTutorial_10_0.png" src="../_images/Tutorials_MicrographAnalysisTutorial_10_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">micrograph</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Tutorials_MicrographAnalysisTutorial_11_0.png" src="../_images/Tutorials_MicrographAnalysisTutorial_11_0.png" />
</div>
</div>
<p>You’ll see that the results are different, this is because I have specified the size plotted in the object. There are lots of options to plot images with matplotlib and I recommend looking into them if you require clearer observation in an iPython environment. I generally use simple functions to plot here, and save the output for display purposes though.</p>
</section>
</section>
<section id="Other-properties-and-metadata">
<h2>Other properties and metadata<a class="headerlink" href="#Other-properties-and-metadata" title="Permalink to this headline"></a></h2>
<p>Now we have the most important thing sorted, the image. However, theres lots of other useful information stored in a Micrograph object, this is particularly true when opening a digital micrograph file. We can access this as follows:</p>
<section id="What-is-the-pixel-size-of-my-image?">
<h3>What is the pixel size of my image?<a class="headerlink" href="#What-is-the-pixel-size-of-my-image?" title="Permalink to this headline"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">micrograph</span><span class="o">.</span><span class="n">pixelSize</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.08174395561218262
</pre></div></div>
</div>
<p>well that could mean anything, what is the unit?</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">micrograph</span><span class="o">.</span><span class="n">pixelUnit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
nm
</pre></div></div>
</div>
<p>Oh cool, what magnification does that mean it was?</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">micrograph</span><span class="o">.</span><span class="n">get_mag</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Indicated mag: 40000.0
Actual mag: 61166.6
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(40000.0, 61166.6)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39;This function prints the magnifications, but also returns them (as floating point numbers)</span>
<span class="sd">    so you can have them for further use&#39;&#39;&#39;</span>
<span class="c1">#indicated_mag, actual_mag = micrograph.get_mag()</span>
<span class="c1">#print(indicated_mag, actual_mag)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;This function prints the magnifications, but also returns them (as floating point numbers) \n    so you can have them for further use&#39;
</pre></div></div>
</div>
<p>How about other imaging conditions? Voltage? Exposure? Acquisition date and time?</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">voltage</span> <span class="o">=</span> <span class="n">micrograph</span><span class="o">.</span><span class="n">get_voltage</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">voltage</span><span class="p">)</span>

<span class="n">exposure</span> <span class="o">=</span> <span class="n">micrograph</span><span class="o">.</span><span class="n">get_exposure</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exposure time: &#39;</span><span class="p">,</span><span class="n">exposure</span><span class="p">,</span><span class="s1">&#39;seconds&#39;</span><span class="p">)</span>

<span class="n">micrograph</span><span class="o">.</span><span class="n">get_date_time</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
200000.0
Imaging time: 8.0s
Exposure time:  8.0 seconds
Date: 14/03/2022
Time 11:36:00
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(&#39;14/03/2022&#39;, &#39;11:36:00&#39;)
</pre></div></div>
</div>
<p>Hold on a second! Why do some of these require brackets (eg. .get_voltage(), but some don’t e.g. .pixelSize?</p>
<p><em>It seemed to me writing this some properties are required often so should be saved as default, others my only be required at specific occasions and can be kept hidden. The good thing is, once you have run these ‘getter’ functions, the data is printed, returned and saved to the object. This final point means once you have run the getters once, you can just try this:</em></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">micrograph</span><span class="o">.</span><span class="n">voltage</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">micrograph</span><span class="o">.</span><span class="n">exposure</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">micrograph</span><span class="o">.</span><span class="n">AqDate</span><span class="p">,</span> <span class="n">micrograph</span><span class="o">.</span><span class="n">AqTime</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">micrograph</span><span class="o">.</span><span class="n">indicated_mag</span><span class="p">,</span> <span class="n">micrograph</span><span class="o">.</span><span class="n">actual_mag</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
200000.0
8.0
14/03/2022 11:36:00
40000.0 61166.6
</pre></div></div>
</div>
<p>Ok this is good, but I need to check a very specific setting, is this saved anywhere?</p>
<p><em>Well I’m not making any promises but if the setting is saved in the image metadata it should be available if you are willing to look for it. Try here:</em></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#micrograph.show_metadata()</span>

<span class="c1">#This is wont appear because it would take up several pages.</span>
</pre></div>
</div>
</div>
<p>Well it’s there, but I want to find this on a whole bunch of files, is there a way to avoid looking through the list each time?</p>
<p><em>Yes, the metadata is saved as a dictionary in Micrograph.metadata_tags, find the name of the parameter from above and access it as follows:</em></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">micrograph</span><span class="o">.</span><span class="n">metadata_tags</span><span class="p">[</span><span class="s1">&#39;.ImageList.2.ImageTags.Acquisition.Device.Name&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;K2-0001&#39;
</pre></div></div>
</div>
<p><em>You can even save it to the object as follows:</em></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#micrograph.Detector_model = micrograph.metadata_tags[&#39;.ImageList.2.ImageTags.Acquisition.Device.Source Model&#39;]</span>
<span class="c1">#print(micrograph.Detector_model)</span>
</pre></div>
</div>
</div>
<p><em>if theres a setting you want regularly, you might consider making a getter function within the Micrograph_class.py file, search for the get_voltage() function for an example of how to do this</em></p>
</section>
</section>
<section id="Micrograph-Editing">
<h2>Micrograph Editing<a class="headerlink" href="#Micrograph-Editing" title="Permalink to this headline"></a></h2>
<p>These are some basic functions to edit the micrograph.</p>
<section id="Convert-to-8-bit">
<h3>Convert to 8 bit<a class="headerlink" href="#Convert-to-8-bit" title="Permalink to this headline"></a></h3>
<p>Micrographs generally come as 32-bit or 16-bit images, this means the pixel values can between 0 and (2^16-1) or (2^32-1), with 32-bit having the added complication of having floating point numbers (decimals) rather than just integers. This allows much more data to be kept in an individual image, and much more contrast available in the individual image. However, most uses for images (including simple viewing with the majority of programs) require 8-bit images. Therefore, we often need to convert
to 8-bit, so there is a simple method to do so provided in the Micrograph object:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">micrograph8bit</span> <span class="o">=</span> <span class="n">micrograph</span><span class="o">.</span><span class="n">convert_to_8bit</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>We can check if it works by checking the pixel values of the image:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Original max = </span><span class="si">{}</span><span class="s1"> :  8bit max =  </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">micrograph</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">micrograph8bit</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Original min = </span><span class="si">{}</span><span class="s1"> :  8bit min =  </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">micrograph</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">micrograph8bit</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">min</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Original mean= </span><span class="si">{}</span><span class="s1"> :  8bit mean=  </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">micrograph</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">micrograph8bit</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Original max = 126.60851287841797 :  8bit max =  255
Original min = 49.76383972167969 :  8bit min =  0
Original mean= 85.82498168945312 :  8bit mean=  119.16476004601454
</pre></div></div>
</div>
<p>We can see this therefore scales the image between 0 and 255 (2^8 - 1) and makes the values integers, thus making it an 8-bit image Lets just check to see what effect it has on the image:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">micrograph</span><span class="o">.</span><span class="n">show_pair</span><span class="p">(</span><span class="n">micrograph8bit</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">title1</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">,</span> <span class="n">title2</span><span class="o">=</span><span class="s1">&#39;8-bit&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Tutorials_MicrographAnalysisTutorial_38_0.png" src="../_images/Tutorials_MicrographAnalysisTutorial_38_0.png" />
</div>
</div>
<p>No obvious effect?! This is for 2 reasons: - Firstly, we cant see all the contrast contained in the image, for viewing purposes 8bit is as good as we need, the additional contrast from higher bit images only helps when contrast is edited/enhanced. - Secondly, I have plotted this with plt.imshow from matplotlib. This automatically scales the image to show the minimum value in the image as black and the max as white.</p>
<p>Lets try plotting it with a defined max and min value (which is what we would see when saving the image):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">micrograph</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">micrograph8bit</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;8-bit&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Tutorials_MicrographAnalysisTutorial_40_0.png" src="../_images/Tutorials_MicrographAnalysisTutorial_40_0.png" />
</div>
</div>
<p>Now we can see the difference.</p>
<p>Converting to 8-bit will therefore enhance the contrast by scaling it between the max and min values of an 8-bit image. It is also required to perform many functions, many of these will convert automatically when using the micrograph object, but its good to keep this in mind.</p>
</section>
</section>
<section id="Improving-contrast">
<h2>Improving contrast<a class="headerlink" href="#Improving-contrast" title="Permalink to this headline"></a></h2>
<p>Contrast can be enhanced using Three different functions: micrograph.clip_contrast(), micrograph.enhance_contrast() and micrograph.eqHist(), the latter two both make use of <a class="reference external" href="https://docs.opencv.org/3.4/d3/dc1/tutorial_basic_linear_transform.html">functions from openCV</a>.</p>
<p>My favourite however, is clip contrast because this will give the most consistent results.</p>
<section id="Clip-Contrast">
<h3>Clip Contrast<a class="headerlink" href="#Clip-Contrast" title="Permalink to this headline"></a></h3>
<p>A digital image is an array of pixels with values between a maximum and minimum value, which in the case of 8 bit images are 0 and 255. The number of pixels with each value can be seen in a histogram, a built in function for this is included in the micrograph object:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">micrograph8bit</span><span class="o">.</span><span class="n">plot_histogram</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Tutorials_MicrographAnalysisTutorial_44_0.png" src="../_images/Tutorials_MicrographAnalysisTutorial_44_0.png" />
</div>
</div>
<p>We can see in this histogram that the image does not include the full range of pixel intensities, and instead is mainly in the range of 50-150. This means the image will look ‘flat’ or ‘grey’ containing few examples of true black or true white in the image. we can see this if we plot it with defined values:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">micrograph8bit</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Tutorials_MicrographAnalysisTutorial_46_0.png" src="../_images/Tutorials_MicrographAnalysisTutorial_46_0.png" />
</div>
</div>
<p>See? We have no black or white pixels, instead we just see shades of grey.</p>
<p>To improve this, we can just pull the histogram so that the pixel range represented by the peak in the histogram, 50-150 are spread over the range 0 to 255. This is where the clip_contrast function comes in:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">micrograph8bit_enhanced</span> <span class="o">=</span> <span class="n">micrograph8bit</span><span class="o">.</span><span class="n">clip_contrast</span><span class="p">(</span><span class="n">maxvalue</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">minvalue</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">micrograph8bit_enhanced</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">micrograph8bit_enhanced</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="mi">255</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Tutorials_MicrographAnalysisTutorial_49_0.png" src="../_images/Tutorials_MicrographAnalysisTutorial_49_0.png" />
</div>
</div>
<p>Looks a bit better right!</p>
<p>But what if we don’t want to have to manually choose the range to clip the contrast? Well theres a value which can be used instead of the max and min value - the saturation.</p>
<p>The saturation is the percentage of pixels in the original video that will be set to 0 or 255 (and are therefore ‘saturated’). Therefore this is a value which increases with the contrast. This is by default set to 0.5 which is quite a strong contrast, however the value can be set manually.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">micrograph8bit_clipped05</span> <span class="o">=</span> <span class="n">micrograph8bit</span><span class="o">.</span><span class="n">clip_contrast</span><span class="p">()</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">micrograph8bit_clipped05</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">micrograph8bit_clipped05</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="mi">255</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Maxmium value :  184
Minimum value :  58
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Tutorials_MicrographAnalysisTutorial_51_1.png" src="../_images/Tutorials_MicrographAnalysisTutorial_51_1.png" />
</div>
</div>
<p>That gives a stronger effect!</p>
<p>Lets look at how the saturation changes the contrast:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">saturations</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">25</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">15</span>

                                    <span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">saturations</span><span class="p">)):</span>
    <span class="n">sat</span> <span class="o">=</span> <span class="n">saturations</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">clipped</span> <span class="o">=</span> <span class="n">micrograph8bit</span><span class="o">.</span><span class="n">clip_contrast</span><span class="p">(</span><span class="n">saturation</span> <span class="o">=</span> <span class="n">sat</span><span class="p">)</span>
    <span class="n">j</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">if</span> <span class="n">i</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">:</span>
        <span class="n">j</span><span class="o">=</span><span class="mi">1</span>
        <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">-</span><span class="mi">3</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">clipped</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Saturation = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sat</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Maxmium value :  198
Minimum value :  47
Maxmium value :  184
Minimum value :  58
Maxmium value :  178
Minimum value :  64
Maxmium value :  160
Minimum value :  80
Maxmium value :  150
Minimum value :  88
Maxmium value :  135
Minimum value :  103
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Tutorials_MicrographAnalysisTutorial_53_1.png" src="../_images/Tutorials_MicrographAnalysisTutorial_53_1.png" />
</div>
</div>
</section>
<section id="Enhance_contrast">
<h3>Enhance_contrast<a class="headerlink" href="#Enhance_contrast" title="Permalink to this headline"></a></h3>
<p>Takes either 2 or 3 inputted values, these are alpha, beta and gamma (optional). - Alpha controls contrast, and is normally used in ranges of 1-3. - Beta is a brightness control and simply adds this value to every pixel in the image. This will only have a major affect with 8-bit images and is best used with values between -100 and +100 (negative is making the image darker. - Gamma controls contrast in a non-linear way. Values between 0-1 makes the image brighter (particularly dark pixels) whilst
values &gt;1 darken the image. Gamma requires an 8bit image and if included will automatically convert the image to 8bit.</p>
<p>For more information on these I recommend the link above.</p>
<p>The default is to run with alpha=1.5, beta=0 and no gamma. This is difficult to automate, and so its best to choose settings manually.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">micrograph_alpha2</span> <span class="o">=</span> <span class="n">micrograph8bit</span><span class="o">.</span><span class="n">enhance_contrast</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">micrograph8bit</span><span class="o">.</span><span class="n">show_pair</span><span class="p">(</span><span class="n">micrograph_alpha2</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">title1</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">,</span> <span class="n">title2</span><span class="o">=</span><span class="s1">&#39;Alpha=2&#39;</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Tutorials_MicrographAnalysisTutorial_55_0.png" src="../_images/Tutorials_MicrographAnalysisTutorial_55_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">micrograph_beta50</span> <span class="o">=</span> <span class="n">micrograph8bit</span><span class="o">.</span><span class="n">enhance_contrast</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">micrograph8bit</span><span class="o">.</span><span class="n">show_pair</span><span class="p">(</span><span class="n">micrograph_beta50</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">title1</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">,</span> <span class="n">title2</span><span class="o">=</span><span class="s1">&#39;Beta=50&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Tutorials_MicrographAnalysisTutorial_56_0.png" src="../_images/Tutorials_MicrographAnalysisTutorial_56_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">micrograph_gamma05</span> <span class="o">=</span> <span class="n">micrograph8bit</span><span class="o">.</span><span class="n">enhance_contrast</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">micrograph8bit</span><span class="o">.</span><span class="n">show_pair</span><span class="p">(</span><span class="n">micrograph_gamma05</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">title1</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">,</span> <span class="n">title2</span><span class="o">=</span><span class="s1">&#39;Gamma=0.4&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Gamma adjusted...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Tutorials_MicrographAnalysisTutorial_57_1.png" src="../_images/Tutorials_MicrographAnalysisTutorial_57_1.png" />
</div>
</div>
</section>
<section id="Histogram-equalisation">
<h3>Histogram equalisation<a class="headerlink" href="#Histogram-equalisation" title="Permalink to this headline"></a></h3>
<p>Histogram equalisation is a method to ensure the pixel values spread the possible values much evenly, flattening the histogram of pixel values. This process can be very effective at enhancing features, particularly with in images with a very dark patch or a very bright patch, the contrast in the midtones can be massively enhanced.</p>
<p>This again only works on 8bit images, and thus the method in the micrograph object automatically converts it to 8bit using the function detailed above.</p>
<p>This implementation also uses openCV and more information on the process can be <a class="reference external" href="https://docs.opencv.org/3.4/d4/d1b/tutorial_histogram_equalization.html">found here</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">micrographHistEQ</span> <span class="o">=</span> <span class="n">micrograph</span><span class="o">.</span><span class="n">eqHist</span><span class="p">()</span>
<span class="n">micrograph</span><span class="o">.</span><span class="n">show_pair</span><span class="p">(</span><span class="n">micrographHistEQ</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">title1</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">,</span> <span class="n">title2</span><span class="o">=</span><span class="s1">&#39;Histogram equalised&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Tutorials_MicrographAnalysisTutorial_59_0.png" src="../_images/Tutorials_MicrographAnalysisTutorial_59_0.png" />
</div>
</div>
</section>
</section>
<section id="Micrograph-Filters!">
<h2>Micrograph Filters!<a class="headerlink" href="#Micrograph-Filters!" title="Permalink to this headline"></a></h2>
<p>Now we are getting to the fun bit. Micrographs can look a bit rubbish as raw files, lets see if we can use the micrograph object to improve it a bit!</p>
<p>These filters have been implemented to make them as simple as possible to use. I encourage users to familiarise yourselves with the filter and the code behind it (see Image filters section of Micrograph_class.py), as there may be settings which I have not made available for simplicity’s sake but could be useful for you. However, for normal analysis, these should be perfectly effective.</p>
<p>In SimpliPyTEM, filters return a new micrograph object with a filtered image, this allows trying different filters/parameters without risking overwriting the image.</p>
<p>First, lets see how it looks already:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">micrograph</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Original image&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Tutorials_MicrographAnalysisTutorial_61_0.png" src="../_images/Tutorials_MicrographAnalysisTutorial_61_0.png" />
</div>
</div>
<p>Looks quite noisy, lets try to filter it a bit…</p>
<section id="Gaussian-filter">
<h3>Gaussian filter<a class="headerlink" href="#Gaussian-filter" title="Permalink to this headline"></a></h3>
<p>This is one of the most common image filters and is used to smooth an image. Here I use OpenCV’s image function within the Micrograph_class, keeping only one setting: the kernal, this needs to be an odd integer. A bigger kernal leads to a stronger blurring effect.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#this is the syntax for image filters:</span>
<span class="n">MicrographGaussian</span> <span class="o">=</span> <span class="n">micrograph</span><span class="o">.</span><span class="n">gaussian_filter</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<p>So here I’ve done a gaussian filter of the micrograph, which returns a new micrograph object that has been gaussian filtered. The kernal is defined by the ‘7’ - this means a 7px by 7px kernal. 7Px is a large filter</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MicrographGaussian</span><span class="o">.</span><span class="n">show_pair</span><span class="p">(</span><span class="n">micrograph</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">title1</span><span class="o">=</span><span class="s1">&#39;Gaussian filter&#39;</span><span class="p">,</span> <span class="n">title2</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span> <span class="c1">#</span>
<span class="c1"># this is a built in function to view a pair of images side by side using plt.subplots</span>
<span class="c1"># you this can be improved by making your own function, but this works for a quick check</span>
<span class="c1"># here the first</span>
<br/><br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Tutorials_MicrographAnalysisTutorial_65_0.png" src="../_images/Tutorials_MicrographAnalysisTutorial_65_0.png" />
</div>
</div>
</section>
<section id="Median-Filter">
<h3>Median Filter<a class="headerlink" href="#Median-Filter" title="Permalink to this headline"></a></h3>
<p>This is another common filter, and can effectively reduce ‘salt-and-pepper’ noise (anomalously low or high pixel values), this replaces each pixel with the median of the pixels around it in an n*n square, where n is the kernal size. Again, the kernal size has to be odd, and a larger number gives a stonger effect.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><br/><span></span><span class="n">MicrographMedian</span> <span class="o">=</span> <span class="n">micrograph</span><span class="o">.</span><span class="n">median_filter</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">MicrographMedian</span><span class="o">.</span><span class="n">show_pair</span><span class="p">(</span><span class="n">micrograph</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">title1</span><span class="o">=</span><span class="s1">&#39;Median filter&#39;</span><span class="p">,</span><span class="n">title2</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Tutorials_MicrographAnalysisTutorial_67_0.png" src="../_images/Tutorials_MicrographAnalysisTutorial_67_0.png" />
</div>
</div>
</section>
<section id="Weiner-filter">
<h3>Weiner filter<a class="headerlink" href="#Weiner-filter" title="Permalink to this headline"></a></h3>
<p>This is a more complex filter, which can filter out noise from corrupted signal. It can be effective for TEM images. This is implemented using the scipy.signal library.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">micrographWeiner</span> <span class="o">=</span> <span class="n">micrograph</span><span class="o">.</span><span class="n">weiner_filter</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">micrographWeiner</span><span class="o">.</span><span class="n">show_pair</span><span class="p">(</span><span class="n">micrograph</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">title1</span><span class="o">=</span><span class="s1">&#39;Median filter&#39;</span><span class="p">,</span> <span class="n">title2</span> <span class="o">=</span> <span class="s1">&#39;Original&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Tutorials_MicrographAnalysisTutorial_69_0.png" src="../_images/Tutorials_MicrographAnalysisTutorial_69_0.png" />
</div>
</div>
</section>
<section id="Low-pass-filtering">
<h3>Low pass filtering<a class="headerlink" href="#Low-pass-filtering" title="Permalink to this headline"></a></h3>
<p>This filters the image based on the fourier transform of the image, allowing one to filter it to a required resolution. While this generally produces patterned artefacts, it can greatly enhance the contrast while sacrificing the higher resolution features. I have found this to be very effective at enhancing large, low contrast features.</p>
<p>Assuming your micrograph object has a pixel size defined, the filter works by removing any features smaller than the size you input as a parameter (the unit is the same as the pixelsize). Therefore, a larger number yields a stronger filter. Beware because if it is too large, you won’t see any features. Effective filter sizes depends on features and magnification, but maybe start with something like 5 and tune it to your needs.</p>
<p>If your micrograph is missing a pixelsize (maybe because you are not using a micrograph file, but a regular tif), then the size input will be the radius of a circle kept in the power spectrum. The result of this is the input number does the inverse - a smaller number leads to stronger filter. In this case, much larger numbers will be needed, so maybe start with 50 and from there.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">micrographLowPass_5nm</span> <span class="o">=</span> <span class="n">micrograph</span><span class="o">.</span><span class="n">low_pass_filter</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1">#filtering to 5nm</span>
<span class="n">micrographLowPass_5nm</span><span class="o">.</span><span class="n">show_pair</span><span class="p">(</span><span class="n">micrograph</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">title1</span><span class="o">=</span><span class="s1">&#39;5nm Low pass Filter&#39;</span><span class="p">,</span> <span class="n">title2</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Tutorials_MicrographAnalysisTutorial_71_0.png" src="../_images/Tutorials_MicrographAnalysisTutorial_71_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">micrographLowPass_1nm</span> <span class="o">=</span> <span class="n">micrograph</span><span class="o">.</span><span class="n">low_pass_filter</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#filtering to 1nm</span>
<span class="n">micrographLowPass_10nm</span> <span class="o">=</span> <span class="n">micrograph</span><span class="o">.</span><span class="n">low_pass_filter</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">micrographLowPass_1nm</span><span class="o">.</span><span class="n">show_pair</span><span class="p">(</span><span class="n">micrographLowPass_10nm</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">title1</span><span class="o">=</span><span class="s1">&#39;1nm Low pass Filter&#39;</span><span class="p">,</span> <span class="n">title2</span><span class="o">=</span><span class="s1">&#39;10nm Low Pass Filter&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Tutorials_MicrographAnalysisTutorial_72_0.png" src="../_images/Tutorials_MicrographAnalysisTutorial_72_0.png" />
</div>
</div>
<p>Here the 5nm LP filter greatly enhances the fibre in the image, while the 1nm shows a much more subtle, but still noticable improvement. 10nm is too strong however, and only artefacts remain.</p>
</section>
<section id="Non-local-means-filter">
<h3>Non-local means filter<a class="headerlink" href="#Non-local-means-filter" title="Permalink to this headline"></a></h3>
<p>This is a filter implemented using the openCV library, and <a class="reference external" href="https://docs.opencv.org/3.4/d5/d69/tutorial_py_non_local_means.html">their description of the process</a> is pretty good. It denoises by comparing and averaging over different areas of the image. This can be effective, even if it does not appear so in this example.</p>
<p>There are a few parameters allowed by openCV but I have only included one in this implementation - h, h controls the strength of the filter, with a bigger number leading to better noise removal but also more removal of the image.</p>
<p>I don’t find this filter amazing but I’m sure in certain circumstances it will be effective.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">micrographNLM</span> <span class="o">=</span> <span class="n">micrograph</span><span class="o">.</span><span class="n">nlm_filter</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">micrographNLM</span><span class="o">.</span><span class="n">show_pair</span><span class="p">(</span><span class="n">micrograph</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">title1</span><span class="o">=</span><span class="s1">&#39;Non-Local means filter&#39;</span><span class="p">,</span> <span class="n">title2</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Tutorials_MicrographAnalysisTutorial_75_0.png" src="../_images/Tutorials_MicrographAnalysisTutorial_75_0.png" />
</div>
</div>
</section>
</section>
<section id="Add-a-scalebar">
<h2>Add a scalebar<a class="headerlink" href="#Add-a-scalebar" title="Permalink to this headline"></a></h2>
<p>Every microscopist knows an micrograph means nothing without a scalebar, so I’ve made the process very easy. With a single command, it will choose a scalebar length, position and color (either black or white depending on contrast in local area).</p>
<p>I recommend adding the scalebar as a final step to the analysis process, because the scale bar perminently changes the pixel values to the max or min value, which will mess with any contrast enhancement (particularly scaling the image to the max and min). Also the filters will blur the scalebar.</p>
<p>Unlike all the other adjustments, this doesnt return a new image, but will simply modify the image present, this is because it should be the final step and there are no real parameters to adjust to get it right. If you want to keep the original I recommend using deepcopy() to copy the micrograph object, as I have below.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><br/><span></span><span class="n">micrographSB</span> <span class="o">=</span> <span class="n">micrograph</span><span class="o">.</span><span class="n">make_scalebar</span><span class="p">()</span>
<span class="n">micrographSB</span><span class="o">.</span><span class="n">imshow</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Tutorials_MicrographAnalysisTutorial_77_0.png" src="../_images/Tutorials_MicrographAnalysisTutorial_77_0.png" />
</div>
</div>
<p>Oh no! The scalebar has messed up the contrast shown. This is because the image is still a 32-bit image and not scaled between 0 and 255. imshow scales the image between the image max and min. The minimum pixel value was previously ~50, now it is zero. To fix this, convert to 8bit first:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">micrograph8bit</span><span class="o">=</span><span class="n">micrograph</span><span class="o">.</span><span class="n">convert_to_8bit</span><span class="p">()</span>
<span class="n">micrograph8bit</span> <span class="o">=</span> <span class="n">micrograph8bit</span><span class="o">.</span><span class="n">make_scalebar</span><span class="p">()</span>
<span class="n">micrograph8bit</span><span class="o">.</span><span class="n">imshow</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Tutorials_MicrographAnalysisTutorial_79_0.png" src="../_images/Tutorials_MicrographAnalysisTutorial_79_0.png" />
</div>
</div>
</section>
<section id="Saving-the-image">
<h2>Saving the image<a class="headerlink" href="#Saving-the-image" title="Permalink to this headline"></a></h2>
<p>The image can be easily saved from the micrograph object using the method write_image(). This can be used with no input at all, and will create an .jpg image named based on the original filename in the directory you are currently in. You can also specify the name of the output file by adding an input.</p>
<p>Ending the name with .tif will save it as a tif file, this will by default be a 32-bit tif file unless you have previously converted the image to 8bit, and will have the pixel size included as a tag.</p>
<p>You can specify a directory to output the files in with the keyword argument outdir=‘Directory’. This will create the new directory if it doesn’t already exist.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">micrograph</span><span class="o">.</span><span class="n">write_image</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Start name : None
126.60851 49.76384
converting to 8bit
Fibres_1.jpg Done!
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">micrograph8bit</span><span class="o">.</span><span class="n">write_image</span><span class="p">(</span><span class="s1">&#39;Tutorial_image.tif&#39;</span><span class="p">,</span><span class="n">outdir</span><span class="o">=</span><span class="s1">&#39;images&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Start name : images/Tutorial_image.tif
if name :  images/Tutorial_image.tif

images/Tutorial_image_25nmscale.tif Done!
</pre></div></div>
</div>
</section>
</section>
<section id="Automating-Pipelines">
<h1>Automating Pipelines<a class="headerlink" href="#Automating-Pipelines" title="Permalink to this headline"></a></h1>
<p>One big advantage of using python is how easy it is to automate repeat analysis with different files. This can be easily achived using a simple for loop:</p>
<p>Firstly collect the digital micrograph files (e.g. by using os.listdir to collect all the files in the directory, and list comprehension to find only the .dm* files):</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dm_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;.dm&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">dm_files</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="n">micrograph</span> <span class="o">=</span> <span class="n">Micrograph</span><span class="p">()</span>
    <span class="n">micrograph</span><span class="o">.</span><span class="n">open_dm</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="n">micrograph</span> <span class="o">=</span> <span class="n">micrograph</span><span class="o">.</span><span class="n">median_filter</span><span class="p">()</span>
    <span class="n">micrograph</span> <span class="o">=</span> <span class="n">micrograph</span><span class="o">.</span><span class="n">convert_to_8bit</span><span class="p">()</span>
    <span class="n">micrograph</span> <span class="o">=</span> <span class="n">micrograph</span><span class="o">.</span><span class="n">make_scalebar</span><span class="p">()</span>
    <span class="n">micrograph</span><span class="o">.</span><span class="n">imshow</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Fibres_1.dm4
Fibres_1.dm4 opened as a Micrograph object
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Tutorials_MicrographAnalysisTutorial_85_1.png" src="../_images/Tutorials_MicrographAnalysisTutorial_85_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
gold_growth_video_holder_test_070921.dm4
File is an image stack, averaging frames together, if you would open as a video, please us MicroVideo object
gold_growth_video_holder_test_070921.dm4 opened as a Micrograph object
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Tutorials_MicrographAnalysisTutorial_85_3.png" src="../_images/Tutorials_MicrographAnalysisTutorial_85_3.png" />
</div>
</div>
<p>To make this even easier, I have included a function in the Micrograph_class.py file which will do this in a single function:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">dm_files</span><span class="p">:</span>
    <span class="n">default_image_pipeline</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="c1">#There are more settings in this: medfilter=3, gaussfilter=0, scalebar=True, texton = True, xybin=2, color=&#39;Auto&#39;,**kwargs)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Fibres_1.dm4 opened as a Micrograph object
Maxmium value :  184
Minimum value :  62
Start name : Fibres_1
if name :  Fibres_1
Fibres_1_25nmscale.jpg Done!
File is an image stack, averaging frames together, if you would open as a video, please us MicroVideo object
gold_growth_video_holder_test_070921.dm4 opened as a Micrograph object
Maxmium value :  186
Minimum value :  37
Start name : gold_growth_video_holder_test_070921
if name :  gold_growth_video_holder_test_070921
gold_growth_video_holder_test_070921_25nmscale.jpg Done!
</pre></div></div>
</div>
<section id="Getting-more-information">
<h2>Getting more information<a class="headerlink" href="#Getting-more-information" title="Permalink to this headline"></a></h2>
<p>Need help? You can always try the help() method, this shows the details of the function as annotated:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">micrograph</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Help on Micrograph in module SimpliPyTEM.Micrograph_class object:

class Micrograph(builtins.object)
 |  A class holding the micrograph image data along with associated parameters and methods. This makes processing microscope images easier as it collects data and methods into a single place.
 |  The majority of image handling methods here comes from OpenCV, the functions often have more options/parameters, as a result making them both more powerful and more complicated.
 |  This package aims to simplify and automate these functions, however if more functionality is required, I recommend using OpenCV (https://docs.opencv.org/4.x/) as a starting point for your image analysis.
 |  ...
 |  Attributes
 |  ----------
 |  filename:str
 |      The file name opened (blank if not opened in object)
 |  pixelSize:float
 |      The pixel size in the image, should be initialised when opening data assuming the pixel size is included, if not can easily be altered
 |  pixelUnit:str
 |      The unit of the pixel size
 |  metadata_tags:dict
 |      The metadata of the file should be stored in this dictionary (works with digital micrograph files)
 |  shape:tuple
 |      The shape of the image
 |  x:int
 |      The size of the x axis in the image
 |  y:int
 |      The size of the y axis in the image
 |
 |  Methods defined here:
 |
 |  Local_normalisation(self, numpatches, padding=0, pad=False)
 |      Normalises contrast across the image, ensuring even contrast throughout.
 |      Image is taken and split into patches, following which the median of the patches (&#39;local median&#39;) is compared to the median of the image (&#39;global median&#39;).
 |      The patch (local area) is then normalised using the medians (patch = patch* global_median/local_medium) leading to a uniform contrast in the image.
 |
 |      The patch median was chosen so there would be less effect if there is a large dark/bright particle, however if this is too large compared with the patch size it will affect the resulting contrast.
 |
 |      Padding can be applied which will greatly reduce edge artefacts. However doing this well will greatly reduce the
 |      Note: if there is a black region (eg. edge of beam or grid) in the image this may lead to bad results.
 |
 |      Parameters
 |      ----------
 |
 |          numpatches:int
 |              The number of patches on each axis to split the image into, ie image is split into n x n patches and these are given the same median
 |
 |          padding: int
 |              percentage overlap between patches (only used if pad=True)
 |
 |          pad:bool
 |              Setting to true reduces edge artifacts from the patches of the image, however it also greatly increases processing time.
 |
 |      Returns
 |      -------
 |
 |          new_im: Micrograph
 |              Copy of the object with an image that has been locally normalised
 |
 |  __init__(self)
 |      Initialize self.  See help(type(self)) for accurate signature.
 |
 |  add_frames(self, frames)
 |      This is used to create a sum of a series of frames where each frame is a saved in a separate .dm file.
 |
 |      Parameters
 |      ----------
 |          frames:list
 |              A series of frames (name or path+name) to add to the original frame
 |
 |      Output
 |      ------
 |          Adds the frames to the existing frame, self.image is now an average of all the frames.
 |
 |  bin(self, value=2)
 |      This bins (reduces size) of the image on the x and y dimensions by the selected value (e.g. a 4000x4000 pixels image goes to 2000x2000 pixels with a value of 2)
 |
 |      Parameters
 |      ----------
 |          value:int
 |              The scale by which to reduce the image size on each dimension. This is normally kept to powers of 2 but any number (including floating point numbers) should work.
 |      Returns
 |      -------
 |          Binned_image:Micrograph
 |              Copy of micrograph object with reduced image size
 |
 |  choose_scalebar_color(self, color, scalebar_x, scalebar_y, width, height)
 |      Chooses the scalebar color and returns the pixelvalue and text color for the annotation. parameters are most of the outputs from choose_scalebar_size()
 |
 |
 |      Parameters
 |      ----------
 |
 |          scalebar_x: int
 |              x coordinate for the scalebar
 |          scalebar_y: int
 |              y coordinate for the scalebar
 |          width:int
 |              width of scalebar
 |          height:int
 |              height of the scalebar
 |          scalebar_size:int (or float)
 |              Size of the scalebar in scaled units (pixelUnit)
 |
 |  choose_scalebar_size(self)
 |      Function for choosing scalebar size, called through make_scalebar(), not a standalone function.
 |
 |      Returns
 |      -------
 |          scalebar_x: int
 |              x coordinate for the scalebar
 |          scalebar_y: int
 |              y coordinate for the scalebar
 |          width:int
 |              width of scalebar
 |          height:int
 |              height of the scalebar
 |          scalebar_size:int (or float)
 |              Size of the scalebar in scaled units (pixelUnit)
 |
 |  clip_contrast(self, saturation=0.5, maxvalue=None, minvalue=None)
 |      Function for enhancing the contrast in an image by clipping the histogram between two values.
 |      These values can be defined directly or can be automatically decided using a saturation value, which the is percentage of the pixels above or below this value.
 |      I.e, if there are 1,000,000 pixels in an image and the saturation value is 0.1, the method searches the value for which only 0.1% or 1000 pixels are above/below.
 |      These values then become the new minimum and maximum of the image, and are scaled to between 0 and 255.
 |
 |      This method will automatically convert to 8 bit (scale between 0 and 255), if this is an issue raise and it can be changed in future versions.
 |
 |      Parameters
 |      ----------
 |
 |          saturation: Float
 |              The percentage cutoff above/below which the pixels are set to zero/255, default is 0.5% of pixels
 |
 |          maxvalue: int
 |              The maximum value that is being clipped (to be decided from histogram). Optional.
 |
 |          minvalue: int
 |              The minimum value that is being clipped (to be decided from histogram). Optional.
 |
 |      Returns
 |      -------
 |
 |          Contrast_enhanced_micrograph : Micrograph
 |              Return a copy of the object with the contrast clipped at either end of the image
 |
 |      Usage
 |      -----
 |
 |          MicrographContrastClipped = micrograph.clip_contrast(saturation=1)
 |
 |          or
 |
 |          MicrographContrastClipped = micrograph.clip_contrast(maxvalue=220, minvalue=20)
 |
 |  convert_to_8bit(self)
 |      Returns a micrograph object with the image scaled between 0 and 255 (an 8-bit image). Improves contrast and is a more usable image format than higher bits.
 |
 |      Returns
 |      -------
 |          Micrograph8bit : Micrograph
 |              A copy of the micrograph object with the image scaled between 0 and 255
 |
 |  enhance_contrast(self, alpha=1.5, beta=0, gamma=&#39;&#39;)
 |      Function for enhancing contrast. This uses the OpenCV methods detailed here: https://docs.opencv.org/3.4/d3/dc1/tutorial_basic_linear_transform.html.
 |      There are 3 input values which define contast controls: alpha, beta and gamma, the gamma value is optional.
 |
 |      Parameters
 |      ----------
 |
 |          alpha:float
 |              Basic contrast control, usually in the range of 1-3. The histogram is streched.
 |
 |          beta: int (or float)
 |              Brightness control, this will add the value to every pixel in the image, only really has an effect with 8-bit images (and any pixels above 255 will be clipped to this)
 |
 |          gamma:float
 |              Non-linear contrast control, values between 0-1 makes images brighter (particularly the dark areas), while values &gt;1 darken the image(particularly the bright areas)
 |              Optional, if included image will be converted to 8 bit.
 |
 |      Returns
 |      -------
 |
 |          Contrast_enhanced_micrograph : Micrograph
 |              Return a copy of the object with the contrast enhanced.
 |
 |  eqHist(self)
 |      Spreads the contrast across a range of values, leading to an evened, flattened histogram. This can be very effective at enhancing midtones in images with very bright or very dark patches.
 |
 |      Returns
 |      -------
 |          Contrast_enhanced_micrograph : Micrograph
 |              Return a copy of the object with the contrast enhanced.
 |
 |  gaussian_filter(self, kernal=3)
 |      Returns a Gaussian filtered copy of the micrograph object, kernal size defined in the call (default is 3)
 |
 |          Parameters
 |          ----------
 |              n:int
 |                  The n x n kernal for median filter is defined here, *must be an odd integer*
 |
 |          Returns
 |          -------
 |              Gaussian_filtered_object :Micrograph
 |                  Gaussian filtered copy of micrograph object with gaussian filtered image
 |
 |  get_date_time(self)
 |      Prints and returns the aquisition date and time for the image.
 |
 |      Returns
 |      -------
 |
 |          AqDate:str
 |              Date on which the micrograph was captured
 |          AqTime:str
 |              Time at which the micrograph was captured
 |
 |  get_exposure(self)
 |      Prints and returns the exposure time for the image.
 |
 |      Returns
 |      -------
 |
 |          exposure:int
 |              Capture time for the image
 |
 |  get_mag(self)
 |      Returns Micrograph magnifications (indicated and actual) and saves them as micrograph attributes (microscope.indicated_mag, microscope.actual_mag)
 |
 |      Returns
 |      -------
 |
 |          indicated_mag:float
 |              Indicated magnification (i.e. what the microscope tells you the mag is) for the image
 |          actual_mag: float
 |              Actual magnification of the image at the camera.
 |
 |  get_voltage(self)
 |      Returns voltage and saves is as micrograph attribute
 |
 |      Returns
 |      -------
 |
 |          Voltage:int
 |              Microscope voltage for the image
 |
 |  imshow(self, title=&#39;&#39;)
 |      Basic function for plotting the micrograph image
 |
 |      Parameters
 |      ----------
 |
 |          title:str
 |              Optional title to be added to the plot
 |
 |  low_pass_filter(self, radius)
 |      This low pass filters the image. The pixel size is used to scale the radius to whatever the pixel unit is (ie radius 10 is 10nm/10um)
 |      If pixelsize is undefined the radius will refer to pixels only
 |
 |      Parameters
 |      ----------
 |
 |          radius : int (or potentially float)
 |              The effects of this vary depending on if the pixelsize is defined in self.pixelSize.:
 |                   - Assuming your micrograph object has a pixel size defined, the filter works by removing any features smaller than the size you input as a parameter (the unit is the same as the pixelsize), A larger number yields a stronger filter, if it is too large, you won&#39;t see any features.
 |                  Effective filter sizes depends on features and magnification, so with something between 1-5 and tune it to your needs.
 |                  - If your micrograph is missing a pixelsize the size input will be the radius of a circle kept in the power spectrum. Here the input number does the inverse - a smaller number leads to stronger filter. In this case, much larger numbers will be needed, 50 is a good starting value.
 |
 |      Returns
 |      -------
 |              Low_pass_filtered_object :Micrograph
 |                  Low pass filtered copy of micrograph object.
 |
 |  make_scalebar(self, texton=True, color=&#39;Auto&#39;)
 |      Automated method to create a scalebar of a suitable size, shape and color. Returns a new object with a scalebar.
 |      The color will be selected between black and white based on mean value of the region of the scalebar compared to the mean value of the whole video. To override this the color can be defined as black white or grey.
 |      This will work best for 8-bit images, as the scalebar will be given values of 0 or 255.
 |
 |      Parameters
 |      ----------
 |
 |          color : str
 |              The color of the scalebar, the options are &#39;white&#39;. &#39;black&#39; or &#39;grey&#39;
 |          texton : bool
 |              Text can be turned off using texton=False, the selected size of the scalebar can be accessed using micrograph.scalebar_size
 |
 |      Returns
 |      -------
 |          Micrograph_object_with_scalebar: Micrograph
 |              Copy of the micrograph object with a scale bar.
 |
 |  median_filter(self, kernal=3)
 |      Returns a median filtered copy of the micrograph object, kernal size defined in the call (default is 3)
 |
 |          Parameters
 |          ----------
 |              kernal:int
 |                  The n x n kernal for median filter is defined here, must be an odd integer
 |
 |          Returns
 |          -------
 |              Median_filtered_object :Micrograph
 |                  Median filtered copy of micrograph object with median filtered image
 |
 |  motioncor_frames(self, frames_dict)
 |      Advanced method which requires editing the code to use. Uses Motioncor2 to motion correct a series of frames and output a number of motion corrected images as a micrograph object
 |
 |      Parameters
 |      ----------
 |          frames_dict:dict
 |              A dictionary of videos and frames in the directory which will be motion corrected, this is created by the &#39;group_frames()&#39; function
 |
 |      This actually wont work well (will only open the final vid in the frames dictionary). Depreciated function.
 |
 |  motioncorrect_video(self, file)
 |      Advanced method which requires editing the source code to use. Uses Motioncor2 to motion correct a video and output a motion corrected image as a micrograph object
 |
 |      This function first converts the dm3 to an mrc file, followed by using motioncor by the exectuable defined in motion_cor_command - change this executible to use.
 |
 |      An aligned mrc file should be saved in the directory and automatically opened in this Micrograph object.
 |      Parameters
 |      ----------
 |          filename:str
 |              The filename to motion correct
 |
 |  nlm_filter(self, h=5)
 |      Returns a non-local means filtered copy of the micrograph, filter strength is defined in the call.
 |      More information on non-local means filtering can be found here: https://docs.opencv.org/3.4/d5/d69/tutorial_py_non_local_means.html
 |
 |          Parameters
 |          ----------
 |              h:int
 |                  Defines the strength of the Non-local means filter, default is 5
 |          Returns
 |          -------
 |              nlm_filtered_object : Micrograph
 |                  Non-local means filtered copy of the micrograph object
 |
 |  open_dm(self, file, video_average=True, pixel_correction=True)
 |      Imports digital micrograph files into the micrograph object, initialising all the default attributes required, including saving the metadata into self.metadata_tags.
 |      By default, video dm files (dose fractionations) will be summed to create a single image file, there is also an option (video_average) to use the first frame only.
 |
 |      Some DM files have &#39;hot pixels&#39; which have anomalously high signal due to detector malfunction, these often lead to contrast issues.
 |      To correct for this any pixel which has a higher value than the mean value + (20 x standard deviation) is set to the mean pixel value, this is on by default but can be turned off using pixel_correction=False
 |
 |      This uses the ncempy.io.dm package to read DM files, more information can be found here: https://openncem.readthedocs.io/en/latest/ncempy.io.html
 |
 |
 |      Parameters
 |      ----------
 |          file : str
 |              The name of the dm file to open. The path to the file can also be included if it is not in the same directory.
 |
 |          video_average : bool
 |              If file is a video, this controls whether to output an average (sum) of all the frames or the first frame. Default is to average the video (True), change to False to output a single frame
 |
 |          pixel_correction: bool
 |              Set anomalous &#39;hot&#39; pixels to the image mean, anomalous pixels defined as image_mean + 20*image_standard_deviation. Default is on (True).
 |
 |  open_mrc(self, file, pixel_correction=True)
 |      Imports MRC image files into the Micrograph object.
 |
 |      Parameters
 |      ----------
 |          file : str
 |              The name of an MRC file to open, the path to the file can also be included.
 |
 |  plot_histogram(self, sidebyside=False)
 |
 |  reset_xy(self)
 |      Resets the image attributes for the x, y and shape of the image. Used by the binning method and is also useful following cropping of the micrograph
 |
 |  show_metadata(self)
 |      prints the metadata tags, this can be useful for finding the names of metadata features within the metadata.tags file.
 |
 |  show_pair(self, other_image, title1=&#39;&#39;, title2=&#39;&#39;)
 |      Basic function for plotting pairs of images for comparison
 |
 |      Parameters
 |      ----------
 |          other_image : 2D Numpy array
 |              Second image of the plot - if using Micrograph object remember to use micrograph.image
 |          title1 : str
 |              Title for the first image (the object being used to plot the images) - Optional
 |          title2 : str
 |              Title for the second image - Optional
 |
 |  weiner_filter(self, kernal=5)
 |      Returns a Weiner filtered copy of the micrograph object, kernal size defined in the call (default is 5)
 |
 |          Parameters
 |          ----------
 |
 |              n :int
 |                  The n x n kernal for Weiner filter is defined here, must be an odd integer
 |
 |          Returns
 |          -------
 |
 |              Weiner_filtered_object : Micrograph
 |                  Weiner filtered copy of micrograph object
 |
 |  write_image(self, name=None, ftype=&#39;jpg&#39;, outdir=None)
 |      Saves the image in a .jpg or .tif file for display or use with other programs.
 |
 |      Parameters
 |      ----------
 |          name: str
 |              Filename for saved image. Ending with either .jpg or .tif will define the format of the image, alternatively ftype argument can be used.
 |              This is optional, without including a name the name of the original file opened will be used.
 |
 |          ftype: str
 |              Optional. Filetype of output image, either &#39;jpg&#39; or &#39;tif&#39; (default jpg), this is better defined using the suffix of the name.
 |              Saving as a tif will save in whatever format it is currently in - this can be a 32-bit or 8-bit image, using convert_to_8bit() will ensure that latter.
 |
 |          outdir: str
 |              Keyword argument (usage: outdir=&#39;/path/to/directory&#39;). This defines the output location of the saved image, use a path relative to the current directory or an absolute path.
 |              The final directory in the path will be made if it does not already exist.
 |
 |  ----------------------------------------------------------------------
 |  Data descriptors defined here:
 |
 |  __dict__
 |      dictionary for instance variables (if defined)
 |
 |  __weakref__
 |      list of weak references to the object (if defined)
 |
 |  ----------------------------------------------------------------------
 |  Data and other attributes defined here:
 |
 |  __slotnames__ = []

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">micrograph</span><span class="o">.</span><span class="n">make_scalebar</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Help on method make_scalebar in module SimpliPyTEM.Micrograph_class:

make_scalebar(texton=True, color=&#39;Auto&#39;) method of SimpliPyTEM.Micrograph_class.Micrograph instance
    Automated method to create a scalebar of a suitable size, shape and color. Returns a new object with a scalebar.
    The color will be selected between black and white based on mean value of the region of the scalebar compared to the mean value of the whole video. To override this the color can be defined as black white or grey.
    This will work best for 8-bit images, as the scalebar will be given values of 0 or 255.

    Parameters
    ----------

        color : str
            The color of the scalebar, the options are &#39;white&#39;. &#39;black&#39; or &#39;grey&#39;
        texton : bool
            Text can be turned off using texton=False, the selected size of the scalebar can be accessed using micrograph.scalebar_size

    Returns
    -------
        Micrograph_object_with_scalebar: Micrograph
            Copy of the micrograph object with a scale bar.

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">micrograph</span><span class="o">.</span><span class="n">gaussian_filter</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Help on method gaussian_filter in module SimpliPyTEM.Micrograph_class:

gaussian_filter(kernal=3) method of SimpliPyTEM.Micrograph_class.Micrograph instance
    Returns a Gaussian filtered copy of the micrograph object, kernal size defined in the call (default is 3)

        Parameters
        ----------
            n:int
                The n x n kernal for median filter is defined here, *must be an odd integer*

        Returns
        -------
            Gaussian_filtered_object :Micrograph
                Gaussian filtered copy of micrograph object with gaussian filtered image

</pre></div></div>
</div>
</section>
<section id="Any-more-questions?">
<h2>Any more questions?<a class="headerlink" href="#Any-more-questions?" title="Permalink to this headline"></a></h2>
<p>Try raising an issue on github, or email me (Gabriel Ing) at <a class="reference external" href="mailto:ucbtgrb&#37;&#52;&#48;ucl&#46;ac&#46;uk">ucbtgrb<span>&#64;</span>ucl<span>&#46;</span>ac<span>&#46;</span>uk</a> for more help!</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../Micrograph_class.html" class="btn btn-neutral float-left" title="Micrograph Class" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../MicroVideo_class.html" class="btn btn-neutral float-right" title="MicroVideo Class" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Gabriel Ing.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>